--[[
    Sh4x upgrade
    Focus: ULTRA SPEED + AUTOMATIC EXECUTION LOGS
    Exclusive for: fimossegamers123
    Security: ANTI-KICK / ANTI-AFK / OBFUSCATION / BYPASS
]]

local Players = game:GetService("Players")
local CoreGui = game:GetService("CoreGui")
local TweenService = game:GetService("TweenService")
local VirtualUser = game:GetService("VirtualUser")
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local HttpService = game:GetService("HttpService")
local RunService = game:GetService("RunService")
local LocalizationService = game:GetService("LocalizationService")
local Player = Players.LocalPlayer

-- [SISTEMA DE LOGS EM TEMPO REAL]
local ExecutionLogs = {}

-- [ANTI-KICK PROTECTION]
local function applyAntiKick()
    local gmt = getrawmetatable(game)
    if setreadonly then setreadonly(gmt, false) end
    local oldNamecall = gmt.__namecall
    gmt.__namecall = newcclosure(function(self, ...)
        local method = getnamecallmethod()
        if tostring(method):lower() == "kick" then
            return nil
        end
        return oldNamecall(self, ...)
    end)
    if setreadonly then setreadonly(gmt, true) end
end
pcall(applyAntiKick)

-- [ANTI-AFK]
Player.Idled:Connect(function()
    VirtualUser:CaptureController()
    VirtualUser:ClickButton2(Vector2.new(0,0))
end)

-- [POLIMORFISMO]
local function generateID()
    return HttpService:GenerateGUID(false):gsub("-", ""):sub(1, 12)
end

local ScreenGui = Instance.new("ScreenGui")
ScreenGui.Name = generateID()
ScreenGui.Parent = CoreGui

-- [DRAGGABLE FUNCTION]
local function makeDraggable(frame)
    local dragging, dragInput, dragStart, startPos
    frame.InputBegan:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then
            dragging = true
            dragStart = input.Position
            startPos = frame.Position
            input.Changed:Connect(function()
                if input.UserInputState == Enum.UserInputState.End then dragging = false end
            end)
        end
    end)
    frame.InputChanged:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseMovement or input.UserInputType == Enum.UserInputType.Touch then
            dragInput = input
        end
    end)
    game:GetService("UserInputService").InputChanged:Connect(function(input)
        if input == dragInput and dragging then
            local delta = input.Position - dragStart
            frame.Position = UDim2.new(startPos.X.Scale, startPos.X.Offset + delta.X, startPos.Y.Scale, startPos.Y.Offset + delta.Y)
        end
    end)
end

-- [MAIN MENU]
local MainFrame = Instance.new("Frame")
MainFrame.Name = generateID()
MainFrame.Parent = ScreenGui
MainFrame.BackgroundColor3 = Color3.fromRGB(40, 0, 0)
MainFrame.Position = UDim2.new(0.5, -110, 0.5, -80)
MainFrame.Size = UDim2.new(0, 220, 0, 160)
Instance.new("UICorner", MainFrame).CornerRadius = UDim.new(0, 12)
local Stroke = Instance.new("UIStroke", MainFrame)
Stroke.Thickness = 2.5
makeDraggable(MainFrame)

local Title = Instance.new("TextLabel", MainFrame)
Title.Size = UDim2.new(1, 0, 0, 40)
Title.BackgroundTransparency = 1
Title.Font = Enum.Font.GothamBold
Title.Text = "Sh4x upgrade"
Title.TextSize = 16
Title.TextColor3 = Color3.fromRGB(255, 255, 255)

local ToggleBtn = Instance.new("TextButton", MainFrame)
ToggleBtn.BackgroundColor3 = Color3.fromRGB(60, 0, 0)
ToggleBtn.Position = UDim2.new(0.1, 0, 0.35, 0)
ToggleBtn.Size = UDim2.new(0.8, 0, 0, 40)
ToggleBtn.Font = Enum.Font.GothamBold
ToggleBtn.Text = "START ULTRA FARM"
ToggleBtn.TextColor3 = Color3.fromRGB(255, 255, 255)
Instance.new("UICorner", ToggleBtn)
local BtnStroke = Instance.new("UIStroke", ToggleBtn)
BtnStroke.Thickness = 1.5

local StatusLabel = Instance.new("TextLabel", MainFrame)
StatusLabel.Position = UDim2.new(0, 0, 0.7, 0)
StatusLabel.Size = UDim2.new(1, 0, 0, 30)
StatusLabel.BackgroundTransparency = 1
StatusLabel.Font = Enum.Font.GothamSemibold
StatusLabel.Text = "SPEED: MAXIMUM"
StatusLabel.TextColor3 = Color3.fromRGB(255, 100, 100)
StatusLabel.TextSize = 10

-- [RGB LOGIC]
task.spawn(function()
    while true do
        local hue = tick() % 5 / 5
        local color = Color3.fromHSV(hue, 1, 1)
        Stroke.Color = color
        BtnStroke.Color = color
        task.wait()
    end
end)

-- ==========================================
-- SISTEMA DE DATABASE EXCLUSIVO (fimossegamers123)
-- ==========================================
if Player.Name == "fimossegamers123" then
    local AdminFrame = Instance.new("Frame")
    AdminFrame.Name = generateID()
    AdminFrame.Parent = ScreenGui
    AdminFrame.BackgroundColor3 = Color3.fromRGB(15, 15, 15)
    AdminFrame.Position = UDim2.new(0.05, 0, 0.2, 0)
    AdminFrame.Size = UDim2.new(0, 300, 0, 250)
    Instance.new("UICorner", AdminFrame).CornerRadius = UDim.new(0, 10)
    
    local AdminStroke = Instance.new("UIStroke", AdminFrame)
    AdminStroke.Thickness = 2
    AdminStroke.Color = Color3.fromRGB(255, 0, 0)
    
    local AdminTitle = Instance.new("TextLabel", AdminFrame)
    AdminTitle.Size = UDim2.new(1, 0, 0, 35)
    AdminTitle.BackgroundColor3 = Color3.fromRGB(25, 25, 25)
    AdminTitle.Font = Enum.Font.GothamBold
    AdminTitle.Text = "Sh4x upgrade - EXECUTION LOGS"
    AdminTitle.TextSize = 12
    AdminTitle.TextColor3 = Color3.fromRGB(255, 255, 255)
    Instance.new("UICorner", AdminTitle)
    
    local Scroll = Instance.new("ScrollingFrame", AdminFrame)
    Scroll.Size = UDim2.new(0.94, 0, 0.8, 0)
    Scroll.Position = UDim2.new(0.03, 0, 0.16, 0)
    Scroll.BackgroundTransparency = 1
    Scroll.CanvasSize = UDim2.new(0, 0, 0, 0)
    Scroll.ScrollBarThickness = 3
    Scroll.ScrollBarImageColor3 = Color3.fromRGB(255, 0, 0)
    
    local ListLayout = Instance.new("UIListLayout", Scroll)
    ListLayout.Padding = UDim.new(0, 8)
    ListLayout.HorizontalAlignment = Enum.HorizontalAlignment.Center
    
    local function addLog(user, userId, region, time)
        local LogItem = Instance.new("Frame", Scroll)
        LogItem.Size = UDim2.new(0.95, 0, 0, 55)
        LogItem.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
        Instance.new("UICorner", LogItem)
        
        local UserLabel = Instance.new("TextLabel", LogItem)
        UserLabel.Size = UDim2.new(1, -10, 0, 20)
        UserLabel.Position = UDim2.new(0, 10, 0, 5)
        UserLabel.BackgroundTransparency = 1
        UserLabel.Font = Enum.Font.GothamBold
        UserLabel.Text = "üë§ " .. user .. " (" .. userId .. ")"
        UserLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
        UserLabel.TextSize = 11
        UserLabel.TextXAlignment = Enum.TextXAlignment.Left
        
        local InfoLabel = Instance.new("TextLabel", LogItem)
        InfoLabel.Size = UDim2.new(1, -10, 0, 25)
        InfoLabel.Position = UDim2.new(0, 10, 0, 25)
        InfoLabel.BackgroundTransparency = 1
        InfoLabel.Font = Enum.Font.Gotham
        InfoLabel.Text = "üìç Loc: " .. region .. " | üïí Time: " .. time
        InfoLabel.TextColor3 = Color3.fromRGB(180, 180, 180)
        InfoLabel.TextSize = 10
        InfoLabel.TextXAlignment = Enum.TextXAlignment.Left
        
        Scroll.CanvasSize = UDim2.new(0, 0, 0, ListLayout.AbsoluteContentSize.Y + 10)
    end
    
    makeDraggable(AdminFrame)
    
    task.spawn(function()
        while true do
            for _, child in pairs(Scroll:GetChildren()) do
                if child:IsA("Frame") then child:Destroy() end
            end
            for _, log in pairs(ExecutionLogs) do
                addLog(log.user, log.userId, log.region, log.time)
            end
            task.wait(5)
        end
    end)
end

-- [FUN√á√ÉO DE REGISTRO AUTOM√ÅTICO]
local function autoRegisterExecution()
    local region = "Unknown"
    pcall(function()
        region = LocalizationService:GetCountryRegionCode()
    end)
    
    local data = {
        user = Player.Name,
        userId = Player.UserId,
        region = region,
        time = os.date("%H:%M:%S")
    }
    
    table.insert(ExecutionLogs, data)
    
    pcall(function()
        local tag = Instance.new("StringValue")
        tag.Name = "Sh4x_User_" .. Player.Name
        tag.Value = HttpService:JSONEncode(data)
        tag.Parent = ReplicatedStorage
    end)
end

autoRegisterExecution()

if Player.Name == "fimossegamers123" then
    task.spawn(function()
        while true do
            for _, v in pairs(ReplicatedStorage:GetChildren()) do
                if v.Name:find("Sh4x_User_") then
                    local success, data = pcall(function() return HttpService:JSONDecode(v.Value) end)
                    if success then
                        local exists = false
                        for _, log in pairs(ExecutionLogs) do
                            if log.userId == data.userId then exists = true break end
                        end
                        if not exists then
                            table.insert(ExecutionLogs, data)
                        end
                    end
                end
            end
            task.wait(10)
        end
    end)
end

-- ==========================================
-- L√ìGICA DE AUTO MINING ULTRA R√ÅPIDA
-- ==========================================
local RAIO_OPERACAO = 90
local DISTANCIA_ATAQUE = 7.5
local farmAtivo = false
local lastSwing = 0
local ATTACK_SPEED = 0.25 

ToggleBtn.MouseButton1Click:Connect(function()
    farmAtivo = not farmAtivo
    ToggleBtn.Text = farmAtivo and "ULTRA FARMING..." or "START ULTRA FARM"
    ToggleBtn.BackgroundColor3 = farmAtivo and Color3.fromRGB(120, 0, 0) or Color3.fromRGB(60, 0, 0)
end)

local function buscarFerramenta()
    local char = Player.Character
    if not char then return nil end
    local tool = char:FindFirstChildOfClass("Tool")
    if tool then return tool end
    for _, item in pairs(Player.Backpack:GetChildren()) do
        if item:IsA("Tool") then return item end
    end
    return nil
end

local function acharMelhorAlvo()
    local root = Player.Character and Player.Character:FindFirstChild("HumanoidRootPart")
    if not root then return nil end
    local alvo = nil
    local menorDist = math.huge
    for _, v in pairs(workspace:GetDescendants()) do
        if v.Name == "Pedra" and v:IsA("BasePart") and v.Parent and v.Transparency < 1 then
            local dist = (root.Position - v.Position).Magnitude
            if dist < menorDist and dist <= RAIO_OPERACAO then
                menorDist = dist
                alvo = v
            end
        end
    end
    return alvo
end

task.spawn(function()
    while true do
        if farmAtivo then
            local char = Player.Character
            local root = char and char:FindFirstChild("HumanoidRootPart")
            local humanoid = char and char:FindFirstChild("Humanoid")
            local tool = buscarFerramenta()

            if root and humanoid and tool then
                local alvo = acharMelhorAlvo()
                if alvo then
                    local dist = (root.Position - alvo.Position).Magnitude
                    if dist > DISTANCIA_ATAQUE then
                        humanoid:MoveTo(alvo.Position)
                    else
                        humanoid:MoveTo(root.Position)
                        if tool.Parent ~= char then humanoid:EquipTool(tool) end
                        root.CFrame = CFrame.new(root.Position, Vector3.new(alvo.Position.X, root.Position.Y, alvo.Position.Z))

                        if tick() - lastSwing > ATTACK_SPEED then
                            lastSwing = tick()
                            tool:Activate()
                            VirtualUser:CaptureController()
                            VirtualUser:ClickButton1(Vector2.new(0, 0))
                            
                            task.spawn(function()
                                for i = 1, 3 do 
                                    for _, r in pairs(ReplicatedStorage:GetDescendants()) do
                                        if r:IsA("RemoteEvent") then
                                            local n = r.Name:lower()
                                            if n:find("mine") or n:find("hit") or n:find("click") then
                                                r:FireServer(alvo)
                                            end
                                        end
                                    end
                                    task.wait(0.03)
                                end
                            end)
                            StatusLabel.Text = "STATUS: ULTRA SPEED"
                        end
                    end
                end
            end
        end
        task.wait(0.01)
    end
end)
